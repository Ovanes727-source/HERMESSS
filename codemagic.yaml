workflows:
  android-debug-test:
    name: HERMES Translator Build
    environment:
      groups: []
      vars:
        PACKAGE_NAME: "com.hermes.translator"
        BUILD_NUMBER: 1
        VERSION_NAME: "1.0.0-alpha"
        
    scripts:
      # 1. –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û: –°–æ–∑–¥–∞—Ç—å —à—Ä–∏—Ñ—Ç—ã
      - name: Ensure Fonts Exist
        script: |
          echo "üõ°Ô∏è Ensuring HERMES fonts are present..."
          mkdir -p app/src/main/res/font/
          cd app/src/main/res/font/
          
          # –°–æ–∑–¥–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ XML
          echo '<?xml version="1.0" encoding="utf-8"?>
          <font-family xmlns:android="http://schemas.android.com/apk/res/android">
            <font android:font="@font/cinzel_regular" android:fontWeight="400"/>
            <font android:font="@font/cinzel_bold" android:fontWeight="700"/>
          </font-family>' > cinzel.xml
          
          # –°–∫–∞—á–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã
          curl -s -L -o cinzel_regular.ttf "https://raw.githubusercontent.com/georgiau/cinzel/main/fonts/ttf/Cinzel-Regular.ttf"
          curl -s -L -o cinzel_bold.ttf "https://raw.githubusercontent.com/georgiau/cinzel/main/fonts/ttf/Cinzel-Bold.ttf"
          
          echo "‚úÖ HERMES fonts ready"

      # 2. –°–±–æ—Ä–∫–∞ (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –≤–∞—à –∫–æ–¥)
      - name: Build HERMES APK
        script: |
          echo "üî® Building HERMES with ALL features..."
          ./gradlew assembleDebug \
            -PversionCode=$BUILD_NUMBER \
            -PversionName=$VERSION_NAME \
            --stacktrace

      # 3. –ü—Ä–æ–≤–µ—Ä–∫–∞
      - name: Verify Build
        script: |
          if [ -f "app/build/outputs/apk/debug/*.apk" ]; then
            echo "üéâ HERMES SUCCESS! All features:"
            echo "   ‚Ä¢ Audio Capture ‚úì"
            echo "   ‚Ä¢ Game Overlay ‚úì"
            echo "   ‚Ä¢ Vosk Offline ‚úì"
            echo "   ‚Ä¢ ML Kit Translate ‚úì"
            echo "   ‚Ä¢ PS Remote Play ‚úì"
          else
            echo "‚ùå Build failed"
            exit 1
          fi
    
    artifacts:
      - app/build/outputs/apk/debug/*.apk
