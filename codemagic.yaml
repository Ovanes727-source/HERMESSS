workflows:
  android-debug-test:
    name: Android Debug Build (Test)
    environment:
      groups: []
      vars:
        PACKAGE_NAME: "com.hermes.translator"
        BUILD_NUMBER: 1
        VERSION_NAME: "1.0.0-alpha"
        
    scripts:
      # 1. –°–ö–ê–ß–ò–í–ê–ï–ú –ò –£–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–ú GRADLE –ù–ê–ü–†–Ø–ú–£–Æ
      - name: Install Gradle directly
        script: |
          echo "üì¶ Installing Gradle 8.0..."
          
          # –°–∫–∞—á–∏–≤–∞–µ–º Gradle
          wget -q https://services.gradle.org/distributions/gradle-8.0-bin.zip
          unzip -q gradle-8.0-bin.zip
          
          # –î–æ–±–∞–≤–ª—è–µ–º –≤ PATH
          export PATH="$(pwd)/gradle-8.0/bin:$PATH"
          echo "PATH updated: $PATH"
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º
          gradle --version
          echo "‚úÖ Gradle installed"
      
      # 2. –ò–°–ü–û–õ–¨–ó–£–ï–ú GRADLE –ù–ê–ü–†–Ø–ú–£–Æ (–±–µ–∑ ./gradlew)
      - name: Build APK with direct gradle
        script: |
          echo "üî® Building APK with gradle command..."
          
          # –ò—Å–ø–æ–ª—å–∑—É–µ–º gradle –≤–º–µ—Å—Ç–æ ./gradlew
          gradle assembleDebug \
            -PversionCode=$BUILD_NUMBER \
            -PversionName=$VERSION_NAME \
            --stacktrace \
            --no-daemon
      
      # 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ APK
      - name: Check APK
        script: |
          APK_PATH=$(find . -name "*.apk" -path "*/debug/*" | head -1)
          if [ -f "$APK_PATH" ]; then
            echo "üéâ SUCCESS! Hermes Translator APK built!"
            echo "üì¶ File: $APK_PATH"
            echo "üìè Size: $(du -h "$APK_PATH" | cut -f1)"
            
            # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∏—á–∞—Ö
            echo ""
            echo "‚ú® HERMES TRANSLATOR FEATURES:"
            echo "   ‚Ä¢ System Audio Capture (Android 10+)"
            echo "   ‚Ä¢ Vosk Offline Speech Recognition"
            echo "   ‚Ä¢ Google ML Kit Translation"
            echo "   ‚Ä¢ Real-time Game Overlay"
            echo "   ‚Ä¢ PS Remote Play Detection"
            echo "   ‚Ä¢ 4 Translation Modes"
            echo "   ‚Ä¢ 3 Voice Types"
          else
            echo "‚ùå No APK found"
            find . -name "*.apk" -type f
            exit 1
          fi
    
    artifacts:
      - app/build/outputs/apk/debug/*.apk
    
    publishing:
      email:
        recipients:
          - ovanes931@gmail.com
        notify:
          success: true
          failure: true
