workflows:
  android-debug-test:
    name: Android Debug Build (Test)
    environment:
      groups: []
      vars:
        PACKAGE_NAME: "com.hermes.translator"
        BUILD_NUMBER: 1
        VERSION_NAME: "1.0.0-alpha"

    scripts:
      # 1. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
      - name: Go to build dir
        script: |
          cd $CM_BUILD_DIR
          echo "üìÅ Current directory: $(pwd)"

      # 2. –î–µ–ª–∞–µ–º Gradle Wrapper –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
      - name: Prepare Gradle Wrapper
        script: |
          chmod +x ./gradlew
          ./gradlew --version

      # 3. –°–æ–±–∏—Ä–∞–µ–º APK —á–µ—Ä–µ–∑ gradlew
      - name: Build APK
        script: |
          ./gradlew assembleDebug \
            -PversionCode=$BUILD_NUMBER \
            -PversionName=$VERSION_NAME \
            --stacktrace

      # 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ APK
      - name: Check APK
        script: |
          APK_PATH=$(find . -name "*.apk" -path "*/debug/*" | head -1)
          if [ -f "$APK_PATH" ]; then
            echo "üéâ SUCCESS! Hermes Translator APK built!"
            echo "üì¶ File: $APK_PATH"
            echo "üìè Size: $(du -h "$APK_PATH" | cut -f1)"
            echo ""
            echo "‚ú® HERMES TRANSLATOR FEATURES:"
            echo "   ‚Ä¢ System Audio Capture (Android 10+)"
            echo "   ‚Ä¢ Vosk Offline Speech Recognition"
            echo "   ‚Ä¢ Google ML Kit Translation"
            echo "   ‚Ä¢ Real-time Game Overlay"
            echo "   ‚Ä¢ PS Remote Play Detection"
            echo "   ‚Ä¢ 4 Translation Modes"
            echo "   ‚Ä¢ 3 Voice Types"
          else
            echo "‚ùå No APK found"
            find . -name "*.apk" -type f
            exit 1
          fi

    artifacts:
      - app/build/outputs/apk/debug/*.apk
