workflows:
  android-debug-test:
    name: Hermes Translator - Debug Build
    environment:
      groups: []
      vars:
        PACKAGE_NAME: "com.hermes.translator"
        BUILD_NUMBER: 1
        VERSION_NAME: "1.0.0-alpha"
        
    scripts:
      # 0. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã HERMES
      - name: HERMES Structure Check
        script: |
          echo "‚ö° HERMES TRANSLATOR BUILD STARTED ‚ö°"
          echo "========================================"
          echo "üéØ Target: Android Game Audio Translator"
          echo "üì± Package: $PACKAGE_NAME"
          echo "üî¢ Version: $VERSION_NAME ($BUILD_NUMBER)"
          echo ""
          echo "üìÅ Project Structure:"
          echo "   ‚úì Audio Capture Module"
          echo "   ‚úì Game Overlay Service"
          echo "   ‚úì Vosk Recognition"
          echo "   ‚úì Translation Engine"
          echo "   ‚úì UI/UX Components"
          echo "   ‚úì Fonts (Cinzel, Orbitron, Rajdhani)"
          echo "========================================"

      # 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à—Ä–∏—Ñ—Ç–æ–≤ (–µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç –≤ Git)
      - name: Setup HERMES Fonts
        script: |
          echo "üî§ Setting up HERMES UI fonts..."
          mkdir -p app/src/main/res/font/
          
          # –ï—Å–ª–∏ —Ñ–∞–π–ª–æ–≤ –Ω–µ—Ç ‚Äî —Å–∫–∞—á–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä
          if [ ! -f "app/src/main/res/font/cinzel_regular.ttf" ]; then
            echo "‚¨áÔ∏è  Downloading Cinzel (for headers)..."
            curl -s -L -o app/src/main/res/font/cinzel_regular.ttf \
              "https://github.com/georgiau/cinzel/raw/main/fonts/ttf/Cinzel-Regular.ttf"
          fi
          
          if [ ! -f "app/src/main/res/font/orbitron_regular.ttf" ]; then
            echo "‚¨áÔ∏è  Downloading Orbitron (for overlay)..."
            curl -s -L -o app/src/main/res/font/orbitron_regular.ttf \
              "https://github.com/theleagueof/orbitron/raw/master/fonts/ttf/Orbitron-Regular.ttf"
          fi
          
          echo "‚úÖ HERMES fonts ready"

      # 2. Gradle Wrapper (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π)
      - name: Prepare Gradle Wrapper
        script: |
          chmod +x ./gradlew
          ./gradlew --version

      # 3. –°–±–æ—Ä–∫–∞ HERMES
      - name: Build HERMES APK
        script: |
          echo "üî® Building HERMES Translator APK..."
          echo "========================================"
          echo "üîÑ Features being compiled:"
          echo "   ‚Ä¢ System Audio Capture"
          echo "   ‚Ä¢ Real-time Game Overlay"
          echo "   ‚Ä¢ Offline Speech Recognition"
          echo "   ‚Ä¢ PS Remote Play Detection"
          echo "   ‚Ä¢ 4 Translation Modes"
          echo "========================================"
          
          ./gradlew assembleDebug \
            -PversionCode=$BUILD_NUMBER \
            -PversionName=$VERSION_NAME \
            --stacktrace \
            --no-daemon

      # 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
      - name: Verify HERMES Build
        script: |
          APK_PATH=$(find . -name "*debug*.apk" | head -1)
          if [ -f "$APK_PATH" ]; then
            echo ""
            echo "üéâüéâüéâ HERMES TRANSLATOR SUCCESSFULLY BUILT! üéâüéâüéâ"
            echo "================================================"
            echo "üì¶ APK: $(basename $APK_PATH)"
            echo "üìè Size: $(du -h "$APK_PATH" | cut -f1)"
            echo "üî¢ Version: $VERSION_NAME"
            echo ""
            echo "üöÄ READY FOR DEPLOYMENT:"
            echo "   ‚Ä¢ Install on Android 10+ device"
            echo "   ‚Ä¢ Enable 'Display over other apps'"
            echo "   ‚Ä¢ Grant audio capture permission"
            echo "   ‚Ä¢ Start translation in games/PS Remote Play"
            echo "================================================"
          else
            echo "‚ùå HERMES build failed"
            exit 1
          fi
    
    artifacts:
      - app/build/outputs/apk/debug/*.apk
