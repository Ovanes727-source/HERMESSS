workflows:
  android-debug-test:  # ‚Üê –¢–û–ß–ù–û –¢–ê–ö –ñ–ï –ö–ê–ö –í –û–®–ò–ë–ö–ï
    name: HERMES Translator Build
    instance_type: mac_mini_m1
    environment:
      vars:
        PACKAGE_NAME: "com.hermes.translator"
        BUILD_NUMBER: 1
        VERSION_NAME: "1.0.0-alpha"

    scripts:
      - name: Setup Project
        script: |
          echo "‚ö° HERMES TRANSLATOR BUILD STARTED"
          echo "Target: Android Game Audio Translator"
          echo "Package: $PACKAGE_NAME"
          echo "Version: $VERSION_NAME ($BUILD_NUMBER)"

      - name: Fix Fonts
        script: |
          echo "üõ°Ô∏è Creating font files..."
          mkdir -p app/src/main/res/font/
          cd app/src/main/res/font/
          
          # Cinzel.xml
          echo '<?xml version="1.0" encoding="utf-8"?>' > cinzel.xml
          echo '<font-family xmlns:android="http://schemas.android.com/apk/res/android"' >> cinzel.xml
          echo '    xmlns:app="http://schemas.android.com/apk/res-auto">' >> cinzel.xml
          echo '    <font android:fontStyle="normal" android:fontWeight="400"' >> cinzel.xml
          echo '          android:font="@font/cinzel_regular"' >> cinzel.xml
          echo '          app:fontStyle="normal" app:fontWeight="400"' >> cinzel.xml
          echo '          app:font="@font/cinzel_regular"/>' >> cinzel.xml
          echo '    <font android:fontStyle="normal" android:fontWeight="700"' >> cinzel.xml
          echo '          android:font="@font/cinzel_bold"' >> cinzel.xml
          echo '          app:fontStyle="normal" app:fontWeight="700"' >> cinzel.xml
          echo '          app:font="@font/cinzel_bold"/>' >> cinzel.xml
          echo '</font-family>' >> cinzel.xml
          
          # Orbitron.xml
          echo '<?xml version="1.0" encoding="utf-8"?>' > orbitron.xml
          echo '<font-family xmlns:android="http://schemas.android.com/apk/res/android"' >> orbitron.xml
          echo '    xmlns:app="http://schemas.android.com/apk/res-auto">' >> orbitron.xml
          echo '    <font android:fontStyle="normal" android:fontWeight="400"' >> orbitron.xml
          echo '          android:font="@font/orbitron_regular"' >> orbitron.xml
          echo '          app:fontStyle="normal" app:fontWeight="400"' >> orbitron.xml
          echo '          app:font="@font/orbitron_regular"/>' >> orbitron.xml
          echo '    <font android:fontStyle="normal" android:fontWeight="700"' >> orbitron.xml
          echo '          android:font="@font/orbitron_bold"' >> orbitron.xml
          echo '          app:fontStyle="normal" app:fontWeight="700"' >> orbitron.xml
          echo '          app:font="@font/orbitron_bold"/>' >> orbitron.xml
          echo '</font-family>' >> orbitron.xml
          
          # Rajdhani.xml
          echo '<?xml version="1.0" encoding="utf-8"?>' > rajdhani.xml
          echo '<font-family xmlns:android="http://schemas.android.com/apk/res/android"' >> rajdhani.xml
          echo '    xmlns:app="http://schemas.android.com/apk/res-auto">' >> rajdhani.xml
          echo '    <font android:fontStyle="normal" android:fontWeight="300"' >> rajdhani.xml
          echo '          android:font="@font/rajdhani_light"' >> rajdhani.xml
          echo '          app:fontStyle="normal" app:fontWeight="300"' >> rajdhani.xml
          echo '          app:font="@font/rajdhani_light"/>' >> rajdhani.xml
          echo '    <font android:fontStyle="normal" android:fontWeight="400"' >> rajdhani.xml
          echo '          android:font="@font/rajdhani_regular"' >> rajdhani.xml
          echo '          app:fontStyle="normal" app:fontWeight="400"' >> rajdhani.xml
          echo '          app:font="@font/rajdhani_regular"/>' >> rajdhani.xml
          echo '    <font android:fontStyle="normal" android:fontWeight="500"' >> rajdhani.xml
          echo '          android:font="@font/rajdhani_medium"' >> rajdhani.xml
          echo '          app:fontStyle="normal" app:fontWeight="500"' >> rajdhani.xml
          echo '          app:font="@font/rajdhani_medium"/>' >> rajdhani.xml
          echo '</font-family>' >> rajdhani.xml
          
          # –°–∫–∞—á–∞—Ç—å —à—Ä–∏—Ñ—Ç—ã
          echo "‚¨áÔ∏è Downloading font files..."
          curl -s -L -o cinzel_regular.ttf "https://raw.githubusercontent.com/georgiau/cinzel/main/fonts/ttf/Cinzel-Regular.ttf"
          curl -s -L -o cinzel_bold.ttf "https://raw.githubusercontent.com/georgiau/cinzel/main/fonts/ttf/Cinzel-Bold.ttf"
          curl -s -L -o orbitron_regular.ttf "https://raw.githubusercontent.com/theleagueof/orbitron/master/fonts/ttf/Orbitron-Regular.ttf"
          curl -s -L -o orbitron_bold.ttf "https://raw.githubusercontent.com/theleagueof/orbitron/master/fonts/ttf/Orbitron-Bold.ttf"
          curl -s -L -o rajdhani_light.ttf "https://raw.githubusercontent.com/IndianTypeFoundry/Rajdhani/master/fonts/ttf/Rajdhani-Light.ttf"
          curl -s -L -o rajdhani_regular.ttf "https://raw.githubusercontent.com/IndianTypeFoundry/Rajdhani/master/fonts/ttf/Rajdhani-Regular.ttf"
          curl -s -L -o rajdhani_medium.ttf "https://raw.githubusercontent.com/IndianTypeFoundry/Rajdhani/master/fonts/ttf/Rajdhani-Medium.ttf"
          
          echo "‚úÖ Fonts ready"
          ls -la

      - name: Build APK
        script: |
          echo "üî® Building HERMES APK..."
          echo "Features included:"
          echo "‚Ä¢ System Audio Capture"
          echo "‚Ä¢ Game Overlay"
          echo "‚Ä¢ Offline Speech Recognition"
          echo "‚Ä¢ PS Remote Play Detection"
          echo "‚Ä¢ 4 Translation Modes"
          echo "‚Ä¢ 3 Voice Types"
          
          chmod +x ./gradlew
          ./gradlew clean assembleDebug \
            -PversionCode=$BUILD_NUMBER \
            -PversionName=$VERSION_NAME \
            --stacktrace \
            --no-daemon

      - name: Check Result
        script: |
          APK_PATH=$(find . -name "*.apk" -path "*/debug/*" | head -1)
          if [ -f "$APK_PATH" ]; then
            echo "üéâ HERMES TRANSLATOR SUCCESSFULLY BUILT!"
            echo "APK: $(basename "$APK_PATH")"
            echo "Size: $(du -h "$APK_PATH" | cut -f1)"
          else
            echo "‚ùå Build failed"
            exit 1
          fi

    artifacts:
      - app/build/outputs/apk/debug/*.apk
